# ============================================================================
# Medical Imaging Viewer - Environment Configuration
# ISO 27001 A.9.2.4 (Management of secret authentication information)
# ============================================================================
#
# SECURITY NOTICE:
# - NEVER commit .env file to version control
# - Add .env to .gitignore
# - Use strong, unique values for all secrets
# - Rotate secrets regularly (every 90 days recommended)
# - Use different secrets for development, staging, and production
#
# INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Replace all CHANGE_ME values with actual secrets
# 3. Ensure .env has restrictive permissions: chmod 600 .env
#
# GENERATE SECRETS:
# JWT Secret: python -c "import secrets; print(secrets.token_urlsafe(64))"
# Encryption Key: python -c "import os, base64; print(base64.b64encode(os.urandom(32)).decode())"
# Random Password: python -c "import secrets, string; chars=string.ascii_letters+string.digits+string.punctuation; print(''.join(secrets.choice(chars) for _ in range(32)))"
#
# ============================================================================

# ----------------------------------------------------------------------------
# Application Configuration
# ----------------------------------------------------------------------------
APP_NAME="Medical Imaging Viewer"
APP_VERSION="1.0.0"
DEBUG=false
ENVIRONMENT=production
API_V1_STR="/api/v1"

# ----------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------
HOST=0.0.0.0
PORT=8000

# ----------------------------------------------------------------------------
# CORS Configuration (comma-separated list)
# ----------------------------------------------------------------------------
CORS_ORIGINS=https://your-domain.com,https://www.your-domain.com

# ----------------------------------------------------------------------------
# JWT Security (ISO 27001 A.9.4.2) - CRITICAL: CHANGE IN PRODUCTION
# ----------------------------------------------------------------------------
JWT_SECRET_KEY=CHANGE_ME_GENERATE_RANDOM_SECRET_KEY_MIN_64_CHARS
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ----------------------------------------------------------------------------
# Password Policy (ISO 27001 A.9.4.3)
# ----------------------------------------------------------------------------
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_MAX_AGE_DAYS=90
PASSWORD_HISTORY_COUNT=5

# ----------------------------------------------------------------------------
# Account Lockout Policy (ISO 27001 A.9.4.2)
# ----------------------------------------------------------------------------
ACCOUNT_LOCKOUT_THRESHOLD=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30

# ----------------------------------------------------------------------------
# Encryption (ISO 27001 A.10.1.1, A.10.1.2) - CRITICAL: CHANGE IN PRODUCTION
# ----------------------------------------------------------------------------
ENCRYPTION_MASTER_KEY=CHANGE_ME_GENERATE_BASE64_32_BYTE_KEY
KDF_ITERATIONS=100000
KDF_ALGORITHM=SHA256
KEY_ROTATION_DAYS=90

# ----------------------------------------------------------------------------
# Redis Cache Configuration
# ----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
REDIS_MAX_CONNECTIONS=50
REDIS_SSL=false
REDIS_SSL_CERT_REQS=none

# Cache TTL (seconds)
CACHE_DRIVE_FILES_TTL=300
CACHE_IMAGES_TTL=1800
CACHE_METADATA_TTL=600
CACHE_DEFAULT_TTL=3600

# ----------------------------------------------------------------------------
# Google Drive Integration
# ----------------------------------------------------------------------------
GOOGLE_DRIVE_CREDENTIALS_FILE=credentials.json
GOOGLE_DRIVE_TOKEN_FILE=token.json
GOOGLE_DRIVE_SCOPES=https://www.googleapis.com/auth/drive.readonly

# ----------------------------------------------------------------------------
# File Upload Configuration
# ----------------------------------------------------------------------------
MAX_UPLOAD_SIZE=524288000
ALLOWED_EXTENSIONS=.dcm,.nii,.nii.gz,.img,.hdr

# ----------------------------------------------------------------------------
# Logging (ISO 27001 A.12.4.1)
# ----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=logs/app.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=10

# Audit Logging
AUDIT_LOG_FILE=logs/audit.log
AUDIT_LOG_RETENTION_DAYS=365

# ----------------------------------------------------------------------------
# TLS/SSL Configuration (ISO 27001 A.13.1.1, A.13.2.1)
# ----------------------------------------------------------------------------
# Enable TLS/SSL enforcement middleware
TLS_ENABLED=false

# Certificate paths (use absolute paths in production)
TLS_CERT_FILE=/path/to/cert.pem
TLS_KEY_FILE=/path/to/key.pem

# Minimum TLS version (1.2 or 1.3)
# CRITICAL: Use 1.3 in production (TLS 1.0/1.1 deprecated per RFC 8996)
TLS_MIN_VERSION=1.3

# HTTPS enforcement options
# TLS_ENFORCE_HTTPS=true: Reject non-HTTPS requests (strict mode)
# TLS_ENFORCE_HTTPS=false + TLS_REDIRECT_TO_HTTPS=true: Redirect HTTP to HTTPS
# TLS_ENFORCE_HTTPS=false + TLS_REDIRECT_TO_HTTPS=false: Allow HTTP (dev only)
TLS_ENFORCE_HTTPS=true
TLS_REDIRECT_TO_HTTPS=false

# HSTS (HTTP Strict Transport Security) Configuration - RFC 6797
# Forces browsers to use HTTPS for all future requests
HSTS_ENABLED=false
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# HSTS Preload - Submit to Chrome HSTS preload list
# Requires: HSTS_MAX_AGE >= 31536000, HSTS_INCLUDE_SUBDOMAINS=true
# WARNING: Once submitted, removal takes months. Only enable if committed to HTTPS.
HSTS_PRELOAD=false

# Security Headers Level (MINIMAL, STANDARD, STRICT, PARANOID)
# MINIMAL: Basic headers (CSP, X-Frame-Options)
# STANDARD: OWASP recommended (allows inline scripts for React)
# STRICT: Maximum security (no inline scripts, breaks some features)
# PARANOID: Extreme security (breaks most third-party integrations)
SECURITY_HEADER_LEVEL=STANDARD

# Custom Content-Security-Policy (optional, overrides level-based CSP)
# Leave empty to use level-based defaults
CUSTOM_CSP=

# CSP Violation Report URI (optional)
# Browser will POST violation reports to this endpoint
CSP_REPORT_URI=

# Allowed Hosts (comma-separated, for Host header validation)
# Prevents Host header injection attacks
# Use *.domain.com for wildcard subdomains
# Leave empty to allow all hosts (not recommended in production)
ALLOWED_HOSTS=your-domain.com,*.your-domain.com,www.your-domain.com

# ----------------------------------------------------------------------------
# Rate Limiting (ISO 27001 A.12.2.1)
# ----------------------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_LOGIN_PER_MINUTE=5
RATE_LIMIT_REGISTER_PER_MINUTE=3

# ----------------------------------------------------------------------------
# Input Validation (ISO 27001 A.14.2.1, A.14.2.5)
# ----------------------------------------------------------------------------
# Enable automatic input validation middleware
INPUT_VALIDATION_ENABLED=true

# Strict mode: true = block invalid requests, false = log only
# CRITICAL: Always use true in production
INPUT_VALIDATION_STRICT=true

# ----------------------------------------------------------------------------
# Performance Optimization Feature Flags
# ----------------------------------------------------------------------------
# Binary Protocol & WebSocket
ENABLE_BINARY_PROTOCOL=false
ENABLE_WEBSOCKET=false
WEBSOCKET_MAX_CONNECTIONS=100
WEBSOCKET_HEARTBEAT_INTERVAL=30

# Prefetching
ENABLE_PREFETCHING=true
PREFETCH_SLICES=3
PREFETCH_PRIORITY=normal

# Redis Optimization
USE_REDIS_SCAN=true
REDIS_SCAN_COUNT=100

# Cache Warming
ENABLE_CACHE_WARMING=false
CACHE_WARMING_ON_STARTUP=false

# ----------------------------------------------------------------------------
# Monitoring & Alerting (ISO 27001 A.16.1.2)
# ----------------------------------------------------------------------------
MONITORING_ENABLED=true
ALERT_EMAIL=security@your-domain.com
ENABLE_INTRUSION_DETECTION=true
FAILED_LOGIN_ALERT_THRESHOLD=10

# ----------------------------------------------------------------------------
# Compliance (ISO 27001 A.18.1.1)
# ----------------------------------------------------------------------------
COMPLIANCE_MODE=HIPAA_ISO27001
AUDIT_TRAIL_ENABLED=true
DATA_RETENTION_DAYS=2555
PHI_DATA_ENCRYPTION_REQUIRED=true

# ----------------------------------------------------------------------------
# Development Settings (DISABLE IN PRODUCTION)
# ----------------------------------------------------------------------------
ENABLE_API_DOCS=false
ENABLE_SWAGGER_UI=false
ENABLE_DEBUG_TOOLBAR=false

# ============================================================================
# END OF CONFIGURATION
# ============================================================================
